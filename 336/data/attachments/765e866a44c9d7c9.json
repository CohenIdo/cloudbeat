{
    "@timestamp": "2022-04-17T14:51:20.586Z",
    "agent": {
        "ephemeral_id": "be049324-3195-46f8-9f24-6244fb69f398",
        "id": "a1b238ff-8c19-41ef-8dc0-1c4d134a51f6",
        "name": "kind-mono-control-plane",
        "type": "cloudbeat",
        "version": "8.3.0"
    },
    "cloud": {
        "account": {},
        "instance": {
            "id": "5bcaa043-ddd2-482f-a5a1-d720dd689475",
            "name": "EUS2-GHEUS21UBT20EUS29-0082"
        },
        "machine": {
            "type": "Standard_DS2_v2"
        },
        "provider": "azure",
        "region": "eastus2",
        "service": {
            "name": "Virtual Machines"
        }
    },
    "cluster_id": "70c234ac-3680-41b3-a664-b3420565fd49",
    "cycle_id": "fcd16810-7147-4ea3-b20b-57f359c8ae5d",
    "ecs": {
        "version": "8.0.0"
    },
    "host": {
        "architecture": "x86_64",
        "containerized": true,
        "hostname": "kind-mono-control-plane",
        "ip": [
            "10.244.0.1",
            "10.244.0.1",
            "10.244.0.1",
            "10.244.0.1",
            "172.18.0.2",
            "fc00:f853:ccd:e793::2",
            "fe80::42:acff:fe12:2"
        ],
        "mac": [
            "02:42:ac:12:00:02",
            "8a:62:0c:59:fc:52",
            "9a:bf:90:fd:f1:24",
            "e2:c1:11:c9:b2:8b",
            "fe:dc:fc:11:f2:13"
        ],
        "name": "kind-mono-control-plane",
        "os": {
            "codename": "bullseye",
            "family": "debian",
            "kernel": "5.13.0-1021-azure",
            "name": "Debian GNU/Linux",
            "platform": "debian",
            "type": "linux",
            "version": "11 (bullseye)"
        }
    },
    "resource": {
        "command": "/usr/bin/kubelet --bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf --config=/var/lib/kubelet/config.yaml --container-runtime=remote --container-runtime-endpoint=unix:///run/containerd/containerd.sock --fail-swap-on=false --node-ip=172.18.0.2 --node-labels= --pod-infra-container-image=k8s.gcr.io/pause:3.4.1 --provider-id=kind://docker/kind-mono/kind-mono-control-plane --fail-swap-on=false --cgroup-root=/kubelet",
        "external_data": {
            "config": {
                "apiVersion": "kubelet.config.k8s.io/v1beta1",
                "authentication": {
                    "anonymous": {
                        "enabled": false
                    },
                    "webhook": {
                        "cacheTTL": "0s",
                        "enabled": true
                    },
                    "x509": {
                        "clientCAFile": "/etc/kubernetes/pki/ca.crt"
                    }
                },
                "authorization": {
                    "mode": "Webhook",
                    "webhook": {
                        "cacheAuthorizedTTL": "0s",
                        "cacheUnauthorizedTTL": "0s"
                    }
                },
                "cgroupDriver": "cgroupfs",
                "clusterDNS": [
                    "10.96.0.10"
                ],
                "clusterDomain": "cluster.local",
                "cpuManagerReconcilePeriod": "0s",
                "evictionHard": {
                    "imagefs.available": "0%",
                    "nodefs.available": "0%",
                    "nodefs.inodesFree": "0%"
                },
                "evictionPressureTransitionPeriod": "0s",
                "fileCheckFrequency": "0s",
                "healthzBindAddress": "127.0.0.1",
                "healthzPort": 10248,
                "httpCheckFrequency": "0s",
                "imageGCHighThresholdPercent": 100,
                "imageMinimumGCAge": "0s",
                "kind": "KubeletConfiguration",
                "logging": {},
                "nodeStatusReportFrequency": "0s",
                "nodeStatusUpdateFrequency": "0s",
                "rotateCertificates": true,
                "runtimeRequestTimeout": "0s",
                "shutdownGracePeriod": "0s",
                "shutdownGracePeriodCriticalPods": "0s",
                "staticPodPath": "/etc/kubernetes/manifests",
                "streamingConnectionIdleTimeout": "0s",
                "syncFrequency": "0s",
                "volumeStatsAggPeriod": "0s"
            }
        },
        "pid": "715",
        "stat": {
            "EffectiveGID": "",
            "EffectiveUID": "",
            "Group": "715",
            "Name": "kubelet",
            "Nice": "0",
            "Parent": "1",
            "RealGID": "",
            "RealUID": "",
            "ResidentSize": "90292000",
            "SavedGID": "",
            "SavedUID": "",
            "StartTime": "40303",
            "State": "S",
            "SystemTime": "441",
            "Threads": "16",
            "TotalSize": "2053312000",
            "UserTime": "727"
        }
    },
    "resource_id": "715",
    "result": {
        "evaluation": "failed",
        "evidence": {
            "process_args": {
                "--bootstrap-kubeconfig": "/etc/kubernetes/bootstrap-kubelet.conf",
                "--cgroup-root": "/kubelet",
                "--config": "/var/lib/kubelet/config.yaml",
                "--container-runtime": "remote",
                "--container-runtime-endpoint": "unix:///run/containerd/containerd.sock",
                "--fail-swap-on": "false",
                "--kubeconfig": "/etc/kubernetes/kubelet.conf",
                "--node-ip": "172.18.0.2",
                "--node-labels": "",
                "--pod-infra-container-image": "k8s.gcr.io/pause:3.4.1",
                "--provider-id": "kind://docker/kind-mono/kind-mono-control-plane",
                "/usr/bin/kubelet": "/usr/bin/kubelet"
            },
            "process_config": {
                "config": {
                    "apiVersion": "kubelet.config.k8s.io/v1beta1",
                    "authentication": {
                        "anonymous": {
                            "enabled": false
                        },
                        "webhook": {
                            "cacheTTL": "0s",
                            "enabled": true
                        },
                        "x509": {
                            "clientCAFile": "/etc/kubernetes/pki/ca.crt"
                        }
                    },
                    "authorization": {
                        "mode": "Webhook",
                        "webhook": {
                            "cacheAuthorizedTTL": "0s",
                            "cacheUnauthorizedTTL": "0s"
                        }
                    },
                    "cgroupDriver": "cgroupfs",
                    "clusterDNS": [
                        "10.96.0.10"
                    ],
                    "clusterDomain": "cluster.local",
                    "cpuManagerReconcilePeriod": "0s",
                    "evictionHard": {
                        "imagefs.available": "0%",
                        "nodefs.available": "0%",
                        "nodefs.inodesFree": "0%"
                    },
                    "evictionPressureTransitionPeriod": "0s",
                    "fileCheckFrequency": "0s",
                    "healthzBindAddress": "127.0.0.1",
                    "healthzPort": 10248,
                    "httpCheckFrequency": "0s",
                    "imageGCHighThresholdPercent": 100,
                    "imageMinimumGCAge": "0s",
                    "kind": "KubeletConfiguration",
                    "logging": {},
                    "nodeStatusReportFrequency": "0s",
                    "nodeStatusUpdateFrequency": "0s",
                    "rotateCertificates": true,
                    "runtimeRequestTimeout": "0s",
                    "shutdownGracePeriod": "0s",
                    "shutdownGracePeriodCriticalPods": "0s",
                    "staticPodPath": "/etc/kubernetes/manifests",
                    "streamingConnectionIdleTimeout": "0s",
                    "syncFrequency": "0s",
                    "volumeStatsAggPeriod": "0s"
                }
            }
        }
    },
    "rule": {
        "benchmark": {
            "name": "CIS Kubernetes V1.20",
            "version": "v1.0.0"
        },
        "description": "Allow Kubelet to manage iptables.",
        "impact": "Kubelet would manage the iptables on the system and keep it in sync. If you are using any other iptables management solution, then there might be some conflicts.",
        "name": "Ensure that the --make-iptables-util-chains argument is set to true",
        "remediation": "If using a Kubelet config file, edit the file to set makeIPTablesUtilChains: true. If using command line arguments, edit the kubelet service file /etc/systemd/system/kubelet.service.d/10-kubeadm.conf on each worker node and remove the --make-iptables-util-chains argument from the KUBELET_SYSTEM_PODS_ARGS variable. Based on your system, restart the kubelet service.",
        "tags": [
            "CIS",
            "Kubernetes",
            "CIS 4.2.7",
            "Kubelet"
        ]
    },
    "type": "process"
}