{
    "@timestamp": "2022-04-18T10:07:30.322Z",
    "agent": {
        "ephemeral_id": "64593b80-3b62-4808-bdae-b9d2bbc6b06d",
        "id": "5cb93561-b8d9-47c2-bf16-8e4d30576c61",
        "name": "kind-mono-control-plane",
        "type": "cloudbeat",
        "version": "8.3.0"
    },
    "cloud": {
        "account": {},
        "instance": {
            "id": "d4e2c6c5-beeb-4817-bd5d-76e688ac3b93",
            "name": "EUS2-GHEUS21UBT20EUS26-0443"
        },
        "machine": {
            "type": "Standard_DS2_v2"
        },
        "provider": "azure",
        "region": "eastus2",
        "service": {
            "name": "Virtual Machines"
        }
    },
    "cluster_id": "1e5d955f-8d22-4e6b-885c-634d88457f1c",
    "cycle_id": "fcec0c56-c9ae-44a4-9483-95253b3a8156",
    "ecs": {
        "version": "8.0.0"
    },
    "host": {
        "architecture": "x86_64",
        "containerized": true,
        "hostname": "kind-mono-control-plane",
        "ip": [
            "10.244.0.1",
            "10.244.0.1",
            "10.244.0.1",
            "10.244.0.1",
            "172.18.0.2",
            "fc00:f853:ccd:e793::2",
            "fe80::42:acff:fe12:2"
        ],
        "mac": [
            "02:42:ac:12:00:02",
            "26:f6:ba:4a:2a:46",
            "52:d9:bf:fc:89:12",
            "6a:37:2b:75:d8:24",
            "8e:cf:1d:d4:59:71"
        ],
        "name": "kind-mono-control-plane",
        "os": {
            "codename": "bullseye",
            "family": "debian",
            "kernel": "5.13.0-1021-azure",
            "name": "Debian GNU/Linux",
            "platform": "debian",
            "type": "linux",
            "version": "11 (bullseye)"
        }
    },
    "resource": {
        "command": "/usr/bin/kubelet --bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf --config=/var/lib/kubelet/config.yaml --container-runtime=remote --container-runtime-endpoint=unix:///run/containerd/containerd.sock --fail-swap-on=false --node-ip=172.18.0.2 --node-labels= --pod-infra-container-image=k8s.gcr.io/pause:3.4.1 --provider-id=kind://docker/kind-mono/kind-mono-control-plane --fail-swap-on=false --cgroup-root=/kubelet",
        "external_data": {
            "config": {
                "apiVersion": "kubelet.config.k8s.io/v1beta1",
                "authentication": {
                    "anonymous": {
                        "enabled": false
                    },
                    "webhook": {
                        "cacheTTL": "0s",
                        "enabled": true
                    },
                    "x509": {
                        "clientCAFile": "/etc/kubernetes/pki/ca.crt"
                    }
                },
                "authorization": {
                    "mode": "Webhook",
                    "webhook": {
                        "cacheAuthorizedTTL": "0s",
                        "cacheUnauthorizedTTL": "0s"
                    }
                },
                "cgroupDriver": "cgroupfs",
                "clusterDNS": [
                    "10.96.0.10"
                ],
                "clusterDomain": "cluster.local",
                "cpuManagerReconcilePeriod": "0s",
                "evictionHard": {
                    "imagefs.available": "0%",
                    "nodefs.available": "0%",
                    "nodefs.inodesFree": "0%"
                },
                "evictionPressureTransitionPeriod": "0s",
                "fileCheckFrequency": "0s",
                "healthzBindAddress": "127.0.0.1",
                "healthzPort": 10248,
                "httpCheckFrequency": "0s",
                "imageGCHighThresholdPercent": 100,
                "imageMinimumGCAge": "0s",
                "kind": "KubeletConfiguration",
                "logging": {},
                "nodeStatusReportFrequency": "0s",
                "nodeStatusUpdateFrequency": "0s",
                "rotateCertificates": true,
                "runtimeRequestTimeout": "0s",
                "shutdownGracePeriod": "0s",
                "shutdownGracePeriodCriticalPods": "0s",
                "staticPodPath": "/etc/kubernetes/manifests",
                "streamingConnectionIdleTimeout": "0s",
                "syncFrequency": "0s",
                "volumeStatsAggPeriod": "0s"
            }
        },
        "pid": "695",
        "stat": {
            "EffectiveGID": "",
            "EffectiveUID": "",
            "Group": "695",
            "Name": "kubelet",
            "Nice": "0",
            "Parent": "1",
            "RealGID": "",
            "RealUID": "",
            "ResidentSize": "72496000",
            "SavedGID": "",
            "SavedUID": "",
            "StartTime": "48996",
            "State": "S",
            "SystemTime": "689",
            "Threads": "17",
            "TotalSize": "2069700000",
            "UserTime": "1245"
        }
    },
    "resource_id": "695",
    "result": {
        "evaluation": "failed",
        "evidence": {
            "process_args": {
                "--/usr/bin/kubelet": "",
                "--bootstrap-kubeconfig": "/etc/kubernetes/bootstrap-kubelet.conf",
                "--cgroup-root": "/kubelet",
                "--config": "/var/lib/kubelet/config.yaml",
                "--container-runtime": "remote",
                "--container-runtime-endpoint": "unix:///run/containerd/containerd.sock",
                "--fail-swap-on": "false",
                "--kubeconfig": "/etc/kubernetes/kubelet.conf",
                "--node-ip": "172.18.0.2",
                "--node-labels": "",
                "--pod-infra-container-image": "k8s.gcr.io/pause:3.4.1",
                "--provider-id": "kind://docker/kind-mono/kind-mono-control-plane"
            },
            "process_config": {
                "config": {
                    "apiVersion": "kubelet.config.k8s.io/v1beta1",
                    "authentication": {
                        "anonymous": {
                            "enabled": false
                        },
                        "webhook": {
                            "cacheTTL": "0s",
                            "enabled": true
                        },
                        "x509": {
                            "clientCAFile": "/etc/kubernetes/pki/ca.crt"
                        }
                    },
                    "authorization": {
                        "mode": "Webhook",
                        "webhook": {
                            "cacheAuthorizedTTL": "0s",
                            "cacheUnauthorizedTTL": "0s"
                        }
                    },
                    "cgroupDriver": "cgroupfs",
                    "clusterDNS": [
                        "10.96.0.10"
                    ],
                    "clusterDomain": "cluster.local",
                    "cpuManagerReconcilePeriod": "0s",
                    "evictionHard": {
                        "imagefs.available": "0%",
                        "nodefs.available": "0%",
                        "nodefs.inodesFree": "0%"
                    },
                    "evictionPressureTransitionPeriod": "0s",
                    "fileCheckFrequency": "0s",
                    "healthzBindAddress": "127.0.0.1",
                    "healthzPort": 10248,
                    "httpCheckFrequency": "0s",
                    "imageGCHighThresholdPercent": 100,
                    "imageMinimumGCAge": "0s",
                    "kind": "KubeletConfiguration",
                    "logging": {},
                    "nodeStatusReportFrequency": "0s",
                    "nodeStatusUpdateFrequency": "0s",
                    "rotateCertificates": true,
                    "runtimeRequestTimeout": "0s",
                    "shutdownGracePeriod": "0s",
                    "shutdownGracePeriodCriticalPods": "0s",
                    "staticPodPath": "/etc/kubernetes/manifests",
                    "streamingConnectionIdleTimeout": "0s",
                    "syncFrequency": "0s",
                    "volumeStatsAggPeriod": "0s"
                }
            }
        }
    },
    "rule": {
        "benchmark": {
            "name": "CIS Kubernetes V1.20",
            "version": "v1.0.0"
        },
        "description": "Allow Kubelet to manage iptables.\n",
        "impact": "Kubelet would manage the iptables on the system and keep it in sync. If you are using any other iptables management solution, then there might be some conflicts.\n",
        "name": "Ensure that the --make-iptables-util-chains argument is set to true (Automated)",
        "remediation": "If using a Kubelet config file, edit the file to set\n`makeIPTablesUtilChains: true`.\nIf using command line arguments, edit the kubelet service file\n`/etc/systemd/system/kubelet.service.d/10-kubeadm.conf` on each worker node and\nremove the `--make-iptables-util-chains` argument from the\n`KUBELET_SYSTEM_PODS_ARGS` variable.\nBased on your system, restart the `kubelet` service. For example:\n```\nsystemctl daemon-reload\nsystemctl restart kubelet.service\n```\n",
        "tags": [
            "CIS",
            "Kubernetes",
            "CIS 4.2.7",
            "Kubelet"
        ]
    },
    "type": "process"
}